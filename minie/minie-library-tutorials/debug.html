<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Debugging physics issues :: The Minie project</title>
    <link rel="canonical" href="https://stephengold.github.io/Minie/minie/minie-library-tutorials/debug.html">
    <link rel="prev" href="rbc.html">
    <link rel="next" href="character.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta property="og:image" content="../../_/img/iconx128.png">
<meta property="og:description" content="Debugging physics issues">
<meta property="og:title" content="The Minie project">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stephengold.github.io/Minie">
        <img alt="" src="../../_/img/iconx128.png" width="32" type="image/x-icon" style="margin-right:16px">
        The Minie project
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Color themes</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" onclick="setTheme('canyon')">Canyon</a>
            <a class="navbar-item" onclick="setTheme('dark')">Dark</a>
            <a class="navbar-item" onclick="setTheme('jungle')">Jungle</a>
            <a class="navbar-item" onclick="setTheme('light')">Light</a>
            <a class="navbar-item" onclick="setTheme('pastel')">Pastel</a>
            <a class="navbar-item" onclick="setTheme('phosphor')">Phosphor<a>
            <a class="navbar-item" style="padding-top: 5px;padding-left: 1px;padding-right: 1px;"></button>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="minie" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../overview.html">Project links</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implementation.html">Implementation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="add.html">Add to existing project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rigidbody.html">Rigid bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shape.html">Collision shapes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rbc.html">RigidBodyControl</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="debug.html">Debug aids</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="character.html">Characters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vehicle.html">Vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="new6dof.html">New6Dof constraints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dac.html">Ragdolls</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="collision.html">Managing collisions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="softbody.html">Soft bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="server.html">Physics without appstates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="misc.html">Miscellany</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../build.html">Build procedures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../demos.html">Demo apps</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../depends.html">Dependencies</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="https://github.com/stephengold/Minie">Git repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases/latest">Latest release</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases">Recent releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/README.md">ReadMe file</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://raw.githubusercontent.com/stephengold/Minie/master/LICENSE">License</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/MinieLibrary/release-notes.md">Release log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/commits/master">Recent commits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues">Issue tracker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues/new">Report an issue</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library APIs (javadoc)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/master">Master branch</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v7-1">Version 7.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v7-0">Version 7.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v6-2">Version 6.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v6-1">Version 6.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v6-0">Version 6.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v5-1">Version 5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v5-0">Version 5.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-9">Version 4.9</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-8">Version 4.8</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-7">Version 4.7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-6">Version 4.6</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-5">Version 4.5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-4">Version 4.4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-3">Version 4.3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-2">Version 4.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-1">Version 4.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v4-0">Version 4.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v3-1">Version 3.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v3-0">Version 3.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/v2-0">Version 2.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Minie at other sites</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://hub.jmonkeyengine.org/c/user-code-projects/minie/63">JMonkeyEngine forum</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://repo1.maven.org/maven2/com/github/stephengold/Minie">Maven Central download</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://central.sonatype.com/search?q=Minie&amp;namespace=com.github.stephengold">Maven Central search</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://library.jmonkeyengine.org/#!entry=11511%2F38308161-c3cf-4e23-8754-528ca8387c11">JMonkeyEngine Library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://store.jmonkeyengine.org/38308161-c3cf-4e23-8754-528ca8387c11">JmonkeyStore</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jitpack.io/#stephengold/Minie">JitPack (unofficial)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Projects using Minie</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://www.indiedb.com/games/the-afflicted-forests">The Afflicted Forests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/rvandoosselaer/Blocks">Blocks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Garrett">Garrett</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://store.steampowered.com/app/2244540/Marvelous_Marbles">Marvelous Marbles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/jme-vehicles">More Advanced Vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://myworldvw.com">MyWorld</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/tlf30/PhysicsSync">PhysicsSync</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://scenemax3d.com">SceneMax3D</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Other related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Acorus">Acorus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://pybullet.org/wordpress">Bullet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Heart">Heart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeyengine.org">JMonkeyEngine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io/Libbulletjme">Libbulletjme</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/Simsilica/SimMath">SimMath</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/kmammou/v-hacd">V-HACD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/antora-ui-bundle">Website UI bundle</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">People</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://stephengold.github.io">Stephen Gold</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Minie project</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">The Minie project</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../overview.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle-label">Project links</span>
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../overview.html">The Minie project</a></li>
    <li>Library tutorials</li>
    <li><a href="debug.html">Debug aids</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stephengold/Minie/edit/master/MinieLibrary/src/site/antora/tutorials/modules/minie-library-tutorials/pages/debug.adoc">Edit this page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Debugging physics issues</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Minie uses <code>assert</code> statements to verify assumptions made while coding.
During development, Java assertions should be enabled using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the "-ea" JVM argument or</p>
</li>
<li>
<p>the <code>enableAssertions</code> setting of Gradle <code>JavaExec</code> tasks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly, native-code assertions should be enabled during development,
by specifying a Minie library of the "debug" type,
such as "Minie-7.4.0+debug".</p>
</div>
<div class="paragraph">
<p>When a physics simulation doesn&#8217;t behave as expected,
<em>debug visualization</em> should be enabled
to uncover gross issues such as incorrect collision shapes,
incorrect initial positions, bodies that become deactivated,
and collision objects not added to the space.</p>
</div>
<div class="paragraph">
<p>If further details are desired,
temporary print statements may be added at key points.
To streamline this process, Minie provides a configurable <em>dumper</em>
to print out app states, physics spaces, collision shapes, multibodies,
viewports, and scene graphs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debug_visualization_tips_and_tricks"><a class="anchor" href="#_debug_visualization_tips_and_tricks"></a>Debug visualization tips and tricks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debug visualization is disabled by default.
To enable it, configure
the <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/BulletAppState.html"><code>BulletAppState</code></a> thus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">bulletAppState.setDebugEnabled(true);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an example,
see the <a href="https://github.com/stephengold/Minie/blob/master/TutorialApps/src/main/java/jme3utilities/tutorial/HelloRigidBody.java">HelloRigidBody</a> tutorial.</p>
</div>
<div class="sect2">
<h3 id="_high_res_convex_shapes"><a class="anchor" href="#_high_res_convex_shapes"></a>High-res convex shapes</h3>
<div class="paragraph">
<p>By default, debug visualization renders convex collision shapes using meshes
with up to 42 vertex locations.
Alternatively, it can generate debug meshes with up to 256 vertex locations.
To override the low-resolution default on a per-object basis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">collisionObject.setDebugMeshResolution(DebugShapeFactory.highResolution);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This setting is effective only if the object has a convex shape.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mesh_caching"><a class="anchor" href="#_mesh_caching"></a>Mesh caching</h3>
<div class="paragraph">
<p>Debug visualization caches the debug mesh
of every non-compound collision shape it renders.
To clear the cache, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DebugShapeFactory.clearCache();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_viewports"><a class="anchor" href="#_viewports"></a>Viewports</h3>
<div class="paragraph">
<p>By default, debug visualization renders only to the
application&#8217;s main <code>ViewPort</code>.
To specify a different viewport (or an array of viewports) use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">bulletAppState.setDebugViewPorts(viewPortArray);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, see <a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/minie/test/TestDebugToPost.java">TestDebugToPost</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_which_features_are_rendered"><a class="anchor" href="#_which_features_are_rendered"></a>Which features are rendered</h3>
<div class="paragraph">
<p>By default, debug visualization renders the shape of every collision object.
In addition to the shape, Minie can render other features, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>its angular velocity,</p>
</li>
<li>
<p>its axis-aligned bounding box,</p>
</li>
<li>
<p>its gravity vector,</p>
</li>
<li>
<p>its CCD swept sphere, and</p>
</li>
<li>
<p>its velocity vector.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, these features are hidden by default.
To override these defaults,
set <em>filters</em> to specify for which collision objects
each feature should be visualized:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">BulletDebugAppState.DebugAppStateFilter all = new FilterAll(true);
BulletDebugAppState.DebugAppStateFilter none = new FilterAll(false);
bulletAppState.setDebugAngularVelocityFilter(none); // no angular velocities
bulletAppState.setDebugBoundingBoxFilter(all);      // all bounding boxes
bulletAppState.setDebugFilter(none);                // no collision shapes
bulletAppState.setDebugGravityVectorFilter(none);   // no gravity vectors
bulletAppState.setDebugSweptSphereFilter(all);      // all swept spheres
bulletAppState.setDebugVelocityVectorFilter(none);  // no velocity vectors</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_centers_and_local_axes"><a class="anchor" href="#_centers_and_local_axes"></a>Centers and local axes</h3>
<div class="paragraph">
<p>By default, debug visualization doesn&#8217;t indicate
the centers or local axes of collision objects.
To override this default, set the debug axis length to a positive value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">bulletAppState.setAxisLength(1f);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If local axes are visualized, then by default the arrows are one pixel wide.
If your graphics driver supports it, you can specify wider arrows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">bulletAppState.setDebugAxisLineWidth(3f); // axis arrows 3 pixels wide</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can specify "solid" arrows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">bulletAppState.setDebugAxisLineWidth(0f); // solid arrows</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_materials"><a class="anchor" href="#_materials"></a>Materials</h3>
<div class="paragraph">
<p>By default, Minie visualizes the shapes of collision objects
using single-sided wireframe materials.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On Android platforms,
the default debug materials are solid colors instead of wireframes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the material color indicates the type of object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>yellow for a collision object without contact response,
including any <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/PhysicsGhostObject.html"><code>PhysicsGhostObject</code></a>,</p>
</li>
<li>
<p>magenta for a rigid body or
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/MultiBodyCollider.html"><code>MultiBodyCollider</code></a>
that&#8217;s dynamic, responsive, and active,</p>
</li>
<li>
<p>blue for a rigid body or collider
(with contact response) that&#8217;s static or kinematic or inactive,</p>
</li>
<li>
<p>pink for a <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/PhysicsCharacter.html"><code>PhysicsCharacter</code></a>
(with contact response),</p>
</li>
<li>
<p>red for a <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/PhysicsSoftBody.html"><code>PhysicsSoftBody</code></a>
with faces, and</p>
</li>
<li>
<p>orange for a <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/PhysicsSoftBody.html"><code>PhysicsSoftBody</code></a>
with links but no faces.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_number_of_sides"><a class="anchor" href="#_number_of_sides"></a>Number of sides</h4>
<div class="paragraph">
<p>Some collision objects are best visualized using double-sided materials.
You can override the single-sided default on a per-object basis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">collisionObject.setDebugNumSides(2);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>setDebugNumSides(0)</code> makes the object&#8217;s shape invisible
in debug visualization,
even if the object is selected by the debug filter.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_custom_materials"><a class="anchor" href="#_custom_materials"></a>Custom materials</h4>
<div class="paragraph">
<p>If further customization is required, debug materials can be configured
on a per-object basis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">collisionObject.setDebugMaterial(myMaterial);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>setDebugNumSides()</code> has no effect on custom debug materials.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_meshes"><a class="anchor" href="#_meshes"></a>Meshes</h3>
<div class="paragraph">
<p>The default debug materials
don&#8217;t need lighting, normals, or texture coordinates.
By default, debug visualization doesn&#8217;t provide these amenities.
However, a custom debug material might require them.</p>
</div>
<div class="sect3">
<h4 id="_normals"><a class="anchor" href="#_normals"></a>Normals</h4>
<div class="paragraph">
<p>You can override the no-normals default on a per-object basis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">collisionObject1.setDebugMeshNormals(MeshNormals.Facet);
collisionObject2.setDebugMeshNormals(MeshNormals.Smooth);
collisionObject3.setDebugMeshNormals(MeshNormals.Sphere);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_index_buffers"><a class="anchor" href="#_index_buffers"></a>Index buffers</h4>
<div class="paragraph">
<p>Generating index buffers for meshes usually reduces
the number of vertices that must be rendered.
However, generating index buffers for large meshes can take a long time.
By default, Minie doesn&#8217;t generate index buffers for debug meshes
with than 6,000 vertices.</p>
</div>
<div class="paragraph">
<p>You can tune this threshold:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DebugShapeFactory.setIndexBuffers(900);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The threshold has no effect on debug meshes previously generated.
To make this setting retroactive, clear the debug-mesh cache.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lighting_and_shadows"><a class="anchor" href="#_lighting_and_shadows"></a>Lighting and shadows</h3>
<div class="paragraph">
<p><a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/BulletAppState.html"><code>BulletAppState</code></a>
invokes a callback during initialization.
You can use this callback
to provide lighting and/or shadows for debug visualization.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/stephengold/Minie/blob/master/TutorialApps/src/main/java/jme3utilities/tutorial/HelloCustomDebug.java">HelloCustomDebug</a> is a simple
application that demonstrates customization of debug materials,
debug meshes, and lighting.</p>
</div>
</div>
<div class="sect2">
<h3 id="_texture_coordinates"><a class="anchor" href="#_texture_coordinates"></a>Texture coordinates</h3>
<div class="paragraph">
<p><a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/BulletAppState.html"><code>BulletAppState</code></a>
invokes a callback each time it generates a debug mesh.
You can use this callback to add texture coordinates to the mesh:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DebugInitListener callbackObject = new DebugMeshInitListener() {
    public void debugMeshInit(Mesh debugMesh) {
        VertexBuffer pos = debugMesh.getBuffer(VertexBuffer.Type.Position);
        int numVertices = pos.getNumElements();
        FloatBuffer positions = (FloatBuffer) pos.getDataReadOnly();
        FloatBuffer uvs = BufferUtils.createFloatBuffer(2 * numVertices);
        // TODO: fill the UV buffer with data
        debugMesh.setBuffer(VertexBuffer.Type.TexCoord, 2, uvs);
        uvs.flip();
    }
};
collisionObject.setDebugMeshInitListener(callbackObject);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Without texture coordinates,
objects with plane collision shapes are especially tricky to visualize.
For such objects, Minie provides a standard callback class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">float tileSize = 1f;
PlaneDmiListener callbackObject = new PlaneDmiListener(tileSize);
collisionObject.setDebugMeshInitListener(callbackObject);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_an_introduction_to_physicsdumper"><a class="anchor" href="#_an_introduction_to_physicsdumper"></a>An introduction to <code>PhysicsDumper</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following temporary statements could be used to dump
(to <code>System.out</code>) all collision objects in a physics space:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">PhysicsDumper dumper = new PhysicsDumper();
dumper.dump(physicsSpace);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is sample output for a space containing 2 rigid bodies and nothing else:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PhysicsSoftSpace with 0 chars, 0 ghosts, 0 joints, 2 rigids, 0 softs, 0 vehicles
 bphase=DBVT grav[y=-30] timeStep[0.0166667 maxSS=4] listeners[c=0 cg=0 t=1]
 solver[SI iters=10 cfm=0 batch=128 splitImp[th=global erp=0.1] mode=WarmStart,VelocityDependent,SIMD,Cone]
 rayTest=SubSimplex,HeightfieldAccel
 SbwInfo grav[y=-30] offset=0 norm[xyz=0] water=0 air=1.2 maxDisp=1000
  Rigid Sta aData=Material"platform" msLoc[y=-2]
   contact[fric=0.5 rest=0.3 damp=0.1 pth=1e+18 stiff=1e+18]
   Box he[x=20 y=2 z=20] marg=0.04
   with 0 ignores and 0 joints
  Rigid Dyn(mass=1) aData=Material"drop3" msLoc[x=-2.58505 y=0.534056 z=0.95102] loc[x=-2.58505 y=0.534056 z=0.95102] orient[x=0.705 y=0.705 z=0.048 w=0.048]
   contact[fric=0.5 rest=0.3 damp=0.1 pth=1e+18 stiff=1e+18]
   grav[y=-30] NOTprotected ccd[mth=5 r=1.46418] damp[l=0.6 a=0.6] sleep[lth=0.1 ath=0.1 time=0.566667]
   v[x=8.80844e-05 y=-2.33054e-05 z=-4.42515e-05] force[xyz=0] lFact[xyz=1]
   inert[x=0.956287 y=0.496926 z=0.649516] w[x=0.000108026 y=0.000106279 z=-5.59903e-05] torq[xyz=0] aFact[xyz=1]
   MultiSphere r[0.534071 0.534071 0.534071 0.534071] marg=0.04
   with 0 ignores and 0 joints</pre>
</div>
</div>
<div class="paragraph">
<p>2-space indentation indicates the hierarchy of spaces/objects/joints.
Single-space indentation indicates additional description
of the foregoing object.
Related values are enclosed in square brackets.</p>
</div>
<div class="paragraph">
<p>To dump a physics space to a text file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">PrintStream dumpStream = new PrintStream("dump.txt");
PhysicsDumper dumper = new PhysicsDumper(dumpStream);
dumper.dump(physicsSpace);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_what_is_dumped"><a class="anchor" href="#_what_is_dumped"></a>What is dumped</h3>
<div class="paragraph">
<p>You can dump an entire <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/BulletAppState.html"><code>BulletAppState</code></a>,
including its physics space:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.dump(bulletAppState);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can dump specific collision objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.dump(character);
dumper.dump(multiBodyCollider);
dumper.dump(ghostObject);
dumper.dump(rigidBody);
dumper.dump(softBody);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can dump specific collision shapes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.dump(collisionShape, "");</code></pre>
</div>
</div>
<div class="paragraph">
<p>When dumping a space,
the default is to describe every collision object;
physics joints are counted but not described in detail.
To describe the joints in each body, configure the dumper like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.setEnabled(DumpFlags.JointsInBodies, true); // default=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>To describe the motors in each joint, configure the dumper like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.setEnabled(DumpFlags.Motors, true); // default=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>To dump just the physics joints (no collision objects):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">dumper.setEnabled(DumpFlags.Pcos, false); // default=true
dumper.setEnabled(DumpFlags.JointsInSpaces, true); // default=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>When dumping a space, you can apply a filter
to restrict which physics objects are listed.
For instance, to dump only those physics objects that lack a user object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String indent = "";
UserFilter noUser = new UserFilter(null);
dumper.dump(physicsSpace, indent, noUser);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other dump flags can be set to describe the nodes or clusters in each soft body
or the child shapes in each compound collision shape.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>During development, enable Java assertions and use debug-enabled libraries.</p>
</li>
<li>
<p>Use debug visualization to investigate gross issues.</p>
</li>
<li>
<p>To obtain detailed information about scenes and physics, use a dumper.</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="rbc.html">RigidBodyControl</a></span>
  <span class="next"><a href="character.html">Characters</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Page contents" data-levels="3">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright &copy; 2020&ndash;2023 by Stephen Gold</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
